<launch>
    <arg name="serial_no"             default=""/>
    <arg name="json_file_path"        default=""/>
    <arg name="camera"                default="camera"/>

    <group ns="$(arg camera)">
        <include file="$(find realsense2_camera)/launch/includes/nodelet.launch.xml">
            <arg name="stereo_module/exposure/1"  default="7500"/>
            <arg name="stereo_module/gain/1"      default="16"/>
            <arg name="stereo_module/exposure/2"  default="1"/>
            <arg name="stereo_module/gain/2"      default="16"/>

            <arg name="depth_width"       value="640"/>
            <arg name="depth_height"      value="480"/>
            <arg name="depth_fps"         value="30"/>
            <arg name="color_width"       value="640"/>
            <arg name="color_height"      value="480"/>
            <arg name="color_fps"         value="30"/>
            <arg name="enable_depth"      value="true"/>
            <arg name="enable_color"      value="true"/>
            <arg name="enable_infra1"     value="false"/>
            <arg name="enable_infra2"     value="false"/>
            <arg name="enable_fisheye"    value="false"/>
            <arg name="enable_gyro"       value="false"/>
            <arg name="enable_accel"      value="false"/>
            <arg name="enable_pointcloud" value="true"/>
            <arg name="enable_sync"       value="true"/>
            <arg name="align_depth"       value="true"/>
        </include>
    </group>


    <group ns="rtabmap">

        <node name="rtabmap" pkg="rtabmap_ros" type="rtabmap" output="screen" args="">
            <param name="frame_id" type="string" value="base_link"/>

            <param name="subscribe_scan" type="bool" value="true"/>
            <param name="subscribe_rgb"    value="false"/>
            <param name="subscribe_depth"  value="false"/>
            <param name="frame_id"         value="base_link"/>
            <param name="odom_frame_id"    value="odom"/>
            <param name="wait_for_transform_duration"  value="1"/>
            <param name="odom_model_type" value="diff"/>
            
            <!-- <remap from="odom" to="/zed/zed_node/odom" unless="$(arg tango_sim)"/> -->
            <!-- <remap from="scan" to="/scan_filtered" unless="$(arg tango_sim)"/> -->
            
            <remap from="odom" to="/odom" unless="$(arg tango_sim)"/>
            <remap from="scan" to="/scan" unless="$(arg tango_sim)"/>    

            <param name="queue_size" type="int" value="30"/>

            <remap from="grid_map" to="/map"/>

            <!-- RTAB-Map's parameters -->
            <param name="Grid/FromDepth"            type="string" value="false"/> <!-- occupancy grid from lidar -->
            <param name="Reg/Strategy"              value="1"/>    <!-- 1 for lidar -->
            <param name="Reg/Force3DoF"             value="true"/> <!-- 2d slam -->
            <param name="RGBD/NeighborLinkRefining" value="true"/> <!-- odometry correction with scans -->
            
            <!-- ICP parameters -->
            <!-- <param name="Icp/VoxelSize"                 type="string" value="0.05"/> -->
            <!-- <param name="Icp/MaxCorrespondenceDistance" type="string" value="0.1"/> -->
            
        </node>
    </group>
    
    <!-- <node pkg="translate_coords" type="cam_transform.py" name="tf_cam_broadcast" args="_tf_pos:=[5.0,0.0,0.0] _tf_rot:=[0.0,0.0,0.0] _world_frame:='map' _cam_frame:='_link'"/>

    <node pkg="translate_coords" type="cam_to_depthcoords.py" name="camtodepth" required="true"/>
    <node pkg="translate_coords" type="depth_to_mapcoords.py" name="depthtomap" required="true" args="_world_frame:='map' _cam_frame:='_link'"/> -->

</launch>